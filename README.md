# StepMoM
A helper application for OpenMOM.

## Summary
StepMoM は、オープンソースのモーメント法シミュレータであるOpenMOMを使うにあたって、エレメント長などの数値を振って影響を調べるといった作業を用意にすることを目的としたフロントエンドプログラムです。
OpenMOMの詳細については以下のサイトを参照ください。
OpenMOM: <http://www.e-em.co.jp/OpenMOM/>

OpenMOM では、物体形状や周波数、図形出力するデータについてはテキストファイルの.ommに記載して、計算プログラムomm.exe に与えます。
Windows OS 向けには .mmmファイルを編集するGUIプログラムが用意されています。
StepMoMでは、.ommファイルの記載の変更したい箇所を{0},{1},{2}で指示した雛形ファイル)(.smmファイル)を使います。
雛形ファイルから順次 .ommファイルを生成しては計算し、計算結果のファイルを所定の名前に変えて保存することを繰り返します。

## Install
StepMoM.exe を OpenMOMのomm.exeのあるフォルダに置くだけです。

## How to run

1. StepMoM.exeを起動します。ダイアログ画面が開きます。
2. 雛形ファイルを開きます。Referenceボタンをクリックするとファイル選択ダイアログが開きます。使用する雛形ファイル(.smmファイル)を選びます。
3. 値の範囲を指定します。単位に注意してください。GUIのOpenMOM.exeではエレメントの座標の単位はミリメートルですが、.ommファイルではメートル単位です。StepMoMでは、ommファイルで使う単位にあわせてください。
4. Startボタンをクリックして計算を開始します。omm.exeの計算実行に従い、DOS窓がちらちらと開いては閉じます。全体の計算が終わると、Start ボタンの下の矩形エリアにDoneと表示されます。
5. 使用する雛形ファイルのあった場所に、新たにフォルダが作成され、その中に計算結果のファイル一式が置かれています。

## 雛形ファイル .smm について
雛形ファイルの.smmファイルは、.ommファイルのうち変更したい部分を{0},{1},{2}で置き換えたものです。さらに、引用符で囲んだ部分は計算式として解釈します。
たとえば、次に示すものは、OpenMOMでサンプルとして提供されている dipole.omm の3行目で 原点からz方向に±25mm(0.025m)のエレメントで25分割して計算するということを示しています。

geometry = 1 13 -0.025 0.025 0 0 25

これを、以下のようにすると、エレメントの長さを直接置き換える指定となります。

geometry = 1 13 -{0} {0} 0 0 25

また、以下のようにすると、エレメントの長さを元の長さからの変位で指定しています。

geometry = 1 13 "-0.025 - {0}" "0.025 + {0}" 0 0 25

2017.11.05

## Dipole.omm と Dipole.smm について
サンプルとして用意した Dipole.smm は、OpenMOMの一部として配布されているサンプルの Dipole.omm を元に作成した雛形ファイルです。